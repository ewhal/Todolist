<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
		<title>TodoList</title>

		<!-- Material Design fonts -->
		<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Roboto:300,400,500,700">
		<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/icon?family=Material+Icons">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

		<link rel="stylesheet" href="https://cdn.jsdelivr.net/bootstrap.material-design/0.5.10/css/bootstrap-material-design.min.css" integrity="sha256-j3CLSRG31GkOu6kaeLh7XsRgL2YNvRl9aOtXoAYt320=" crossorigin="anonymous">

		<link rel="stylesheet" href="https://cdn.jsdelivr.net/bootstrap.material-design/0.5.10/css/ripples.min.css" integrity="sha256-+Og2qJI9qzvKYwhGo/LYXg0FzE1BhEQfDsUSjKXQ3Bg=" crossorigin="anonymous">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/fontawesome/4.6.3/css/font-awesome.min.css" integrity="sha256-AIodEDkC8V/bHBkfyxzolUMw57jeQ9CauwhVW6YJ9CA=" crossorigin="anonymous">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.6.1/fullcalendar.min.css" type="text/css" rel="stylesheet" />

		<style> .fc-today {opacity: 0;border: none;},fc-event {font-size: inherit !important;font-weight: bold !important;}.fc td, .fc th {border-style: none !important;border-width: 1px !important;padding: 0 !important;vertical-align: top !important;}.fc-event .fc-bg {z-index: 1 !important;background: inherit !important;opacity: .25 !important;}.fc-time-grid-event .fc-time {font-weight: normal !important;}.fc-ltr .fc-h-event.fc-not-end, .fc-rtl .fc-h-event.fc-not-start {opacity: .65 !important;margin-left: 12px !important;padding: 5px !important;}.fc-day-grid-event.fc-h-event.fc-event.fc-not-start.fc-end {opacity: .65 !important;margin-left: 12px !important;padding: 5px !important;}</style>


		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->

	</head>
	<body>
		<div class="bs-component">
			<div class="navbar navbar-default">
				<div class="container">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="/">Home</a>
					</div>
					<div class="navbar-collapse collapse navbar-responsive-collapse">
						<ul class="nav navbar-nav pull-right">
							<li><a href="/user">User</a></li>
							<li><a href="/register">Register</a></li>
							<li><a href="/login">Login</a></li>
							<li><a href="/logout">Logout</a></li>
						</ul>

					</div>
				</div>
			</div>
		</div>


		<div class="container">
			<div class="well">
				<div class="row">
					<div class="col-xs-12">
						<div id="bootstrapModalFullCalendar"></div>
					</div>
				</div>

			</div>
			<a data-toggle="modal" data-target="#addModal" class="btn btn-danger btn-fab pull-right">
				<i class="material-icons fa fa-plus" aria-hidden="true"></i>
				<div class="ripple-container"></div>
			</a>

		</div>

		<div class="modal" id="fullCalModal">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<a data-toggle="modal" data-target="#editModal" class="fa fa-pencil-square-o pull-right"></a>
						<a id="eventDel" class="fa fa-trash pull-right"></a>
						<button type="button" class="close pull-right" data-dismiss="modal" aria-hidden="true">×</button>
						<h4 class="modal-title" id="modalTitle"></h4>
					</div>
					<div id="modalBody" class="modal-body"></div>
					<div class="modal-footer">
						<a class="btn btn-primary" id="eventUrl">Todo Page</a>
					</div>
				</div>
			</div>
		</div>
		<div class="modal" id="addModal">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close pull-right" data-dismiss="modal" aria-hidden="true">×</button>
						<h4 class="modal-title">New Todo</h4>
					</div>
					<div class="modal-body">

						<form class="form-horizontal" id="addForm">
							<fieldset>

								<div class="form-group">

									<div class="form-group is-empty">
										<label for="inputTitle" class="col-md-2 control-label">Title</label>

										<div class="col-md-10">
											<input type="text" class="form-control" id="inputTitle" required name="title" placeholder="Todo title">
										</div>

									</div>

									<div class="form-group is-empty">
										<label for="inputTask" class="col-md-2 control-label">Task</label>

										<div class="col-md-10">
											<input type="text" class="form-control" id="inputTask" required name="task" placeholder="Task">
										</div>

									</div>
									<div class="form-group is-empty">
										<label for="inputCreated" class="col-md-2 control-label">Created</label>

										<div class="col-md-10">
											<input type="datetime-local" class="form-control" id="inputCreated" required name="created">
										</div>

									</div>


									<div class="form-group is-empty">
										<label for="inputDueDate" class="col-md-2 control-label">Due Date</label>

										<div class="col-md-10">
											<input type="datetime-local" class="form-control" id="inputDueDate" required name="duedate">
										</div>

									</div>
									<div class="form-group is-empty">
										<label for="selectPublic" class="col-md-2 control-label">Public</label>

										<div class="col-md-10">
											<select id="selectPublic" class="form-control" name="public">
												<option>true</option>
												<option>false</option>
											</select>
										</div>
									</div>

									<div class="form-group is-empty">
										<label for="selectAllday" class="col-md-2 control-label">Allday</label>

										<div class="col-md-10">
											<select id="selectAllday" class="form-control" name="allday">
												<option>true</option>
												<option>false</option>
											</select>
										</div>
									</div>


								</div>
								<div class="form-group">

									<div class="col-md-10 col-md-offset-2">
										<button type="button" class="btn btn-default"data-dismiss="modal">Cancel</button>
										<button type="submit" id="submitButton" class="btn btn-raised btn-primary">Submit<div class="ripple-container"></div></button>
									</div>
								</div>
							</fieldset>
						</form>
					</div>

					<div class="modal-footer">
					</div>
				</div>
			</div>
		</div>
		<div class="modal" id="editModal">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close pull-right" data-dismiss="modal" aria-hidden="true">×</button>
						<h4 class="modal-title">Edit Todo</h4>
					</div>
					<div class="modal-body">
						<form class="form-horizontal">
							<fieldset>
								<div class="form-group">

									<div class="form-group is-empty">
										<label for="editTitle" class="col-md-2 control-label">Title</label>

										<div class="col-md-10">
											<input type="text" class="form-control" id="editTitle" required name="title">
										</div>

									</div>

									<div class="form-group is-empty">
										<label for="editTask" class="col-md-2 control-label">Task</label>

										<div class="col-md-10">
											<input type="textarea" class="form-control" id="editTask" required name="task">
										</div>

									</div>
									<div class="form-group is-empty">
										<label for="editCreated" class="col-md-2 control-label">Created</label>

										<div class="col-md-10">
											<input type="datetime-local" class="form-control" id="editCreated" required name="created">
										</div>

									</div>


									<div class="form-group is-empty">
										<label for="editDueDate" class="col-md-2 control-label">Due Date</label>

										<div class="col-md-10">
											<input type="datetime-local" class="form-control" id="editDueDate" required name="duedate">
										</div>

									</div>
									<div class="form-group is-empty">
										<label for="editPublic" class="col-md-2 control-label">Public</label>

										<div class="col-md-10">
											<select id="editPublic" class="form-control" name="public">
												<option>true</option>
												<option>false</option>
											</select>
										</div>
									</div>

									<div class="form-group is-empty">
										<label for="editAllday" class="col-md-2 control-label">All Day Task</label>

										<div class="col-md-10">
											<select id="editAllday" class="form-control" name="allday">
												<option>true</option>
												<option>false</option>
											</select>
										</div>
									</div>

								</div>
								<div class="form-group">

									<div class="col-md-10 col-md-offset-2">
										<button type="submit" class="btn btn-raised btn-primary">Submit<div class="ripple-container"></div></button>
									</div>
								</div>
							</fieldset>
						</form>

					</div>
					<div class="modal-footer">
					</div>
				</div>
			</div>
		</div>


		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.2/moment.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/2.6.1/fullcalendar.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/bootstrap.material-design/0.5.10/js/material.min.js" integrity="sha256-uZbIqasulk7Y9yEwknbeQ0FpF3aUhtPwuggbpvQaI8Y=" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/bootstrap.material-design/0.5.10/js/ripples.min.js" integrity="sha256-TY/EO/++Ug/P+fSBjaqlmtuphCBKwlP7TOnS+SGnN8g=" crossorigin="anonymous"></script>




		<script>
			$.material.init();
			$(document).ready(function() { 
				$('#bootstrapModalFullCalendar').fullCalendar({
					events: '/api/cal',
					theme: true,
					header: {
						left: 'prev next',
						center: 'title',
						right: 'today,month,agendaWeek,agendaDay'
					},
					eventClick:  function(event, jsEvent, view) {
						$('#modalTitle').html(event.title);
						$('#modalBody').html(event.description);
						$('#modalTitle').attr('href',"https://todo.pantsu.cat/todo/" + event.url);
						$('#eventUrl').attr('href',"https://todo.pantsu.cat/todo/" + event.url);
						$('#eventEdit').attr('href',"https://todo.pantsu.cat/edit/" + event.url);
						$('#eventDel').attr('href',"https://todo.pantsu.cat/api/cal/" + event.url);
						$('#fullCalModal').modal();
						return false;
					},
				});
				$(".fc-prev-button").addClass("btn btn-primary fa fa-arrow-left");
				$(".fc-next-button").addClass("btn btn-primary fa fa-arrow-right");
				$(".fc-month-button").addClass("btn btn-primary");
				$(".fc-agendaWeek-button").addClass("btn btn-primary");
				$(".fc-agendaDay-button").addClass("btn btn-primary");
				$(".fc-today-button").addClass("btn btn-primary");
				$('input[type=datetime-local]').val(new Date().toJSON().slice(0,19));

				$('#addForm').submit( function() {
					var formdata = $(this).serialize();
					$.ajax({
						type: "POST",
						url: "api/cal",
						data: formdata,
						cache: false,
						success: function(result) {

							$('#addModal').modal('hide');
							setTimeout(function() {
								$('#bootstrapModalFullCalendar').fullCalendar( 'rerenderEvents' );
							}, 4000);

						}
					});
					return false;

				});
				$("#eventDel").click(function(event) {
					$.ajax({
						url: $(this).attr('href'),
						type: "DELETE",
						cache: false,
						success: function(result) {

							$('#fullCalModal').modal('hide');


							setTimeout(function() {
								$('#bootstrapModalFullCalendar').fullCalendar( 'rerenderEvents' );
							}, 4000);
						}
					});
					return false;
				});

			});
		</script>

	</body>
</html>
